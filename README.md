# MelodyVisualizer 🎹🎵

将电钢琴MIDI输入或音频文件转换为绚烂的可视化效果！

## ✨ 功能特性

- **🎹 MIDI实时连接**：支持Web MIDI API，连接电钢琴实时可视化
- **🎵 音频文件分析**：上传MP3/WAV，显示频谱和波形
- **🎆 3D烟花效果**：基于Three.js的粒子爆炸系统
- **📊 频谱可视化**：实时FFT频谱和波形显示
- **⌨️ 虚拟键盘**：显示当前按下的琴键
- **🎨 多种模式**：烟花、频谱、键盘、组合模式
- **🌈 颜色主题**：彩虹、火焰、海洋、霓虹四种配色

## 🚀 快速开始

### 浏览器要求
- **必须使用HTTPS**（Web MIDI API要求）
- Chrome/Edge 60+，Firefox 55+，Safari 11+

### 使用方法
1. 下载所有文件到本地
2. 使用HTTPS服务器运行（或直接在支持HTTPS的在线环境打开）
3. 连接电钢琴或上传音频文件开始体验

### 本地开发
```bash
# 使用Python简单服务器（需要HTTPS包装）
python -m http.server 8000

# 或使用Node.js服务器
npx serve .

# 然后在浏览器访问 https://localhost:8000
```

## 🎮 操作指南

### MIDI模式
1. 连接电钢琴到电脑
2. 点击"刷新设备"
3. 选择你的MIDI设备
4. 弹奏钢琴，观看烟花绽放！

### 音频模式
1. 点击"选择音频文件"
2. 上传MP3/WAV文件
3. 点击"播放"
4. 观看频谱跳动！

### 可视化模式切换
- **烟花**：3D粒子爆炸效果
- **频谱**：音频频谱和波形
- **键盘**：仅显示虚拟键盘
- **组合**：所有效果同时显示

### 参数调节
- **粒子数量**：10-200，控制烟花密度
- **爆炸强度**：0.5-3.0，控制爆炸大小
- **颜色模式**：彩虹/火焰/海洋/霓虹

## 🏗️ 项目结构

```
MelodyVisualizer/
├── index.html          # 主页面
├── style.css           # 样式文件
├── main.js            # 核心逻辑
├── CLAUDE.md          # 开发文档
├── README.md          # 本文件
└── .gitignore         # Git忽略文件
```

### 核心模块
- **MIDIModule**: MIDI设备连接和消息处理
- **AudioModule**: 音频文件加载和分析
- **Fireworks**: Three.js 3D烟花引擎
- **SpectrumVisualizer**: 2D频谱可视化
- **KeyboardDisplay**: 虚拟钢琴键盘

## 🔧 技术栈

- **Web MIDI API**: 电钢琴输入处理
- **Web Audio API**: 音频分析和频谱提取
- **Three.js**: 3D粒子系统和渲染
- **Canvas 2D**: 频谱和波形绘制
- **原生JavaScript**: 无构建工具，纯原生开发

## 📸 效果预览

- **烟花模式**：根据音符频率和力度生成彩色粒子爆炸
- **频谱模式**：实时显示音频频率分布和波形
- **键盘模式**：高亮显示当前按下的琴键
- **组合模式**：所有效果叠加，最炫酷的体验

## 🎯 未来计划

- [ ] 录音功能（麦克风输入）
- [ ] MIDI文件播放
- [ ] 移动端适配
- [ ] 视频导出功能
- [ ] 多人协作模式
- [ ] 自定义着色器效果

## 📝 注意事项

1. **HTTPS要求**：Web MIDI API只能在HTTPS或localhost下工作
2. **浏览器兼容性**：推荐使用最新版Chrome或Edge
3. **性能优化**：如果卡顿，可减少粒子数量或降低爆炸强度
4. **设备支持**：确保电钢琴已正确连接并被浏览器识别

## 🤝 贡献

欢迎提出建议和改进！这是一个个人项目，但希望它能帮助更多人享受音乐可视化的乐趣。

## 📄 许可证

MIT License - 自由使用，欢迎学习和修改。
